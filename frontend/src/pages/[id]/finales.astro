---
import IconUniversity from '@/assets/icons/IconUniversity.astro';
import Breadcrumb from '@/components/common/Breadcrumb.astro';
import ContainerSection from '@/components/common/ContainerSection.astro';
import HeaderResource from '@/components/common/HeaderResource.astro';
import ListOfResources from '@/components/common/ListOfResources.astro';
import { MATERIAS_SISTEMAS } from '@/data/materias';
import Layout from '@/layouts/Layout.astro';
import { getByIdFinales } from '@/services/finales';
import type { Subject } from '@/types/subjects';

export async function getStaticPaths() {
  return MATERIAS_SISTEMAS.map((materia) => ({
    params: { id: materia.url },
  }));
}

const { id } = Astro.params;
const subject = MATERIAS_SISTEMAS.filter((subject) => subject.url == `/${id}`)[0] as Subject;

const { data, error } = await getByIdFinales(subject.id);
---

<Layout>
  <ContainerSection id='finales'>
    <Breadcrumb url={`..${subject.url}`} title={subject.title} />
    <HeaderResource
      title='Finales'
      cantResource={data.length}
      subject={subject.title}
      urlImg='/images/materia-2.png'
      ><IconUniversity size={30} />
    </HeaderResource>
    <ListOfResources resources={data} error={error} type='final' />
  </ContainerSection>
</Layout>
